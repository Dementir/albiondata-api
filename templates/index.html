<html>

<head>
	<script src="https://code.jquery.com/jquery-3.2.1.js" integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.js" integrity="sha256-2/3+Q1kMYR8MDaqFPNBgmLgiqWJjySkg1wqLx/iE5Zo=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.js" integrity="sha256-t3+U9BqykoMN9cqZmJ5Z53TvPv4V7S9AmjUcIWNNyxo=" crossorigin="anonymous"></script>
</head>

<body>
	<div style="width:1200px;height:600px">
		<canvas id="myChart"></canvas>
	</div>
	<script>
        //https://stackoverflow.com/a/7419630
        function rainbow(numOfSteps, step) {
            // This function generates vibrant, "evenly spaced" colours (i.e. no clustering). This is ideal for creating easily distinguishable vibrant markers in Google Maps and other apps.
            // Adam Cole, 2011-Sept-14
            // HSV to RBG adapted from: http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript
            var r, g, b;
            var h = step / numOfSteps;
            var i = ~~(h * 6);
            var f = h * 6 - i;
            var q = 1 - f;
            switch (i % 6) {
                case 0: r = 1; g = f; b = 0; break;
                case 1: r = q; g = 1; b = 0; break;
                case 2: r = 0; g = 1; b = f; break;
                case 3: r = 0; g = q; b = 1; break;
                case 4: r = f; g = 0; b = 1; break;
                case 5: r = 1; g = 0; b = q; break;
            }
            var c = "#" + ("00" + (~ ~(r * 255)).toString(16)).slice(-2) + ("00" + (~ ~(g * 255)).toString(16)).slice(-2) + ("00" + (~ ~(b * 255)).toString(16)).slice(-2);
            return (c);
        }
		var url = "https://www.albion-online-data.com/api/v1/stats/charts/T1_FARM_CARROT_SEED";
		$.getJSON(url, function(json) {
			console.log(json);
			var ctx = document.getElementById("myChart").getContext('2d');
			datasets = [];
			for (var index in json) {
				var item = json[index];
				console.log(item);
				var dataset = {};
				dataset.label = item.location;
				dataset.borderWidth = 2;
				dataset.borderColor = rainbow(json.length, index);
				dataset.fill = false;
				dataset.lineTension = 0;
				dataset.data = [];
				for (var i = 0; i < item.data.timestamps.length; i++) {
					var point = {};
					point.x = item.data.timestamps[i]
					point.y = item.data.prices_avg[i];
					dataset.data.push(point);
				}
				datasets.push(dataset);
			}
			console.log(datasets);
			var myChart = new Chart(ctx, {
				type: 'line',
				data: {
					labels: json[0].data.timestamps,
					datasets: datasets
				},
				options: {
					scales: {
						xAxes: [{
							type: 'time',
							time: {
								unit: 'day',
								tooltipFormat: 'll hA'
							},
							ticks: {
								source: 'auto'
							}
						}]
					}
				}
			});
		});
	</script>
</body>

</html>